(function(){"use strict";var w0=Math.PI,$=w0*2,da=w0/180,Na=180/w0,Ha=1440,Ka=398600.8,C0=6378.135,J0=60/Math.sqrt(C0*C0*C0/Ka),fa=C0*J0/60,Ga=1/J0,X0=.001082616,Ya=-253881e-11,Ja=-165597e-11,$0=Ya/X0,na=2/3,Qa=1440/(2*w0);function Va(r,v){for(var i=[31,r%4===0?29:28,31,30,31,30,31,31,30,31,30,31],n=Math.floor(v),m=1,s=0;n>s+i[m-1]&&m<12;)s+=i[m-1],m+=1;var f=m,x=n-s,h=(v-n)*24,b=Math.floor(h);h=(h-b)*60;var t=Math.floor(h),g=(h-t)*60;return{mon:f,day:x,hr:b,minute:t,sec:g}}function Pa(r,v,i,n,m,s){var f=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;return 367*r-Math.floor(7*(r+Math.floor((v+9)/12))*.25)+Math.floor(275*v/9)+i+17210135e-1+((f/6e4+s/60+m)/60+n)/24}function pa(r,v,i,n,m,s){var f=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(r instanceof Date){var x=r;return Pa(x.getUTCFullYear(),x.getUTCMonth()+1,x.getUTCDate(),x.getUTCHours(),x.getUTCMinutes(),x.getUTCSeconds(),x.getUTCMilliseconds())}return Pa(r,v,i,n,m,s,f)}function Ua(r,v){var i=r.e3,n=r.ee2,m=r.peo,s=r.pgho,f=r.pho,x=r.pinco,h=r.plo,b=r.se2,t=r.se3,g=r.sgh2,N=r.sgh3,w=r.sgh4,e0=r.sh2,S=r.sh3,C=r.si2,O=r.si3,W=r.sl2,H=r.sl3,E=r.sl4,p=r.t,e=r.xgh2,K=r.xgh3,c=r.xgh4,D=r.xh2,d0=r.xh3,I=r.xi2,M=r.xi3,R=r.xl2,X=r.xl3,n0=r.xl4,u=r.zmol,i0=r.zmos,Q=v.init,G=v.opsmode,s0=v.ep,P=v.inclp,y=v.nodep,y0=v.argpp,t0=v.mp,l,d,a0,U,V,T,O0,r0,l0,j,A,v0,F,q,B,z,L,Y,_,Z,J,g0=119459e-10,x0=.01675,z0=.00015835218,M0=.0549;J=i0+g0*p,Q==="y"&&(J=i0),Z=J+2*x0*Math.sin(J),L=Math.sin(Z),j=.5*L*L-.25,A=-.5*L*Math.cos(Z);var D0=b*j+t*A,A0=C*j+O*A,a=W*j+H*A+E*L,c0=g*j+N*A+w*L,h0=e0*j+S*A;J=u+z0*p,Q==="y"&&(J=u),Z=J+2*M0*Math.sin(J),L=Math.sin(Z),j=.5*L*L-.25,A=-.5*L*Math.cos(Z);var P0=n*j+i*A,T0=I*j+M*A,o0=R*j+X*A+n0*L,f0=e*j+K*A+c*L,H0=D*j+d0*A;return v0=D0+P0,B=A0+T0,z=a+o0,F=c0+f0,q=h0+H0,Q==="n"&&(v0-=m,B-=x,z-=h,F-=s,q-=f,P+=B,s0+=v0,U=Math.sin(P),a0=Math.cos(P),P>=.2?(q/=U,F-=a0*q,y0+=F,y+=q,t0+=z):(T=Math.sin(y),V=Math.cos(y),l=U*T,d=U*V,O0=q*V+B*a0*T,r0=-q*T+B*a0*V,l+=O0,d+=r0,y%=$,y<0&&G==="a"&&(y+=$),Y=t0+y0+a0*y,l0=z+F-B*y*U,Y+=l0,_=y,y=Math.atan2(l,d),y<0&&G==="a"&&(y+=$),Math.abs(_-y)>w0&&(y<_?y+=$:y-=$),t0+=z,y0=Y-t0-a0*y)),{ep:s0,inclp:P,nodep:y,argpp:y0,mp:t0}}function Wa(r){var v=r.epoch,i=r.ep,n=r.argpp,m=r.tc,s=r.inclp,f=r.nodep,x=r.np,h,b,t,g,N,w,e0,S,C,O,W,H,E,p,e,K,c,D,d0,I,M,R,X,n0,u,i0,Q,G,s0,P,y,y0,t0,l,d,a0,U,V,T,O0,r0,l0,j,A,v0,F,q,B,z,L,Y,_,Z,J,g0,x0,z0,M0,D0,A0,a,c0,h0,P0=.01675,T0=.0549,o0=29864797e-13,f0=47968065e-14,H0=.39785416,L0=.91744867,p0=.1945905,Q0=-.98088458,U0=x,K0=i,Z0=Math.sin(f),k0=Math.cos(f),q0=Math.sin(n),b0=Math.cos(n),E0=Math.sin(s),G0=Math.cos(s),o=K0*K0,I0=1-o,B0=Math.sqrt(I0),S0=0,k=0,ra=0,ia=0,ha=0,V0=v+18261.5+m/1440,Y0=(4.523602-.00092422029*V0)%$,u0=Math.sin(Y0),N0=Math.cos(Y0),va=.91375164-.03568096*N0,oa=Math.sqrt(1-va*va),j0=.089683511*u0/oa,F0=Math.sqrt(1-j0*j0),m0=5.8351514+.001944368*V0,_0=.39785416*u0/oa,Ma=F0*N0+.91744867*j0*u0;_0=Math.atan2(_0,Ma),_0+=m0-Y0;var ua=Math.cos(_0),ya=Math.sin(_0);I=p0,M=Q0,n0=L0,u=H0,R=k0,X=Z0,W=o0;for(var qa=1/U0,ma=0;ma<2;)ma+=1,h=I*R+M*n0*X,t=-M*R+I*n0*X,e0=-I*X+M*n0*R,S=M*u,C=M*X+I*n0*R,O=I*u,b=G0*e0+E0*S,g=G0*C+E0*O,N=-E0*e0+G0*S,w=-E0*C+G0*O,H=h*b0+b*q0,E=t*b0+g*q0,p=-h*q0+b*b0,e=-t*q0+g*b0,K=N*q0,c=w*q0,D=N*b0,d0=w*b0,a=12*H*H-3*p*p,c0=24*H*E-6*p*e,h0=12*E*E-3*e*e,_=3*(h*h+b*b)+a*o,Z=6*(h*t+b*g)+c0*o,J=3*(t*t+g*g)+h0*o,g0=-6*h*N+o*(-24*H*D-6*p*K),x0=-6*(h*w+t*N)+o*(-24*(E*D+H*d0)+-6*(p*c+e*K)),z0=-6*t*w+o*(-24*E*d0-6*e*c),M0=6*b*N+o*(24*H*K-6*p*D),D0=6*(g*N+b*w)+o*(24*(E*K+H*c)-6*(e*D+p*d0)),A0=6*g*w+o*(24*E*c-6*e*d0),_=_+_+I0*a,Z=Z+Z+I0*c0,J=J+J+I0*h0,q=W*qa,F=-.5*q/B0,B=q*B0,v0=-15*K0*B,z=H*p+E*e,L=E*p+H*e,Y=E*e-H*p,ma===1&&(i0=v0,Q=F,G=q,s0=B,P=z,y=L,y0=Y,t0=_,l=Z,d=J,a0=g0,U=x0,V=z0,T=M0,O0=D0,r0=A0,l0=a,j=c0,A=h0,I=ua,M=ya,n0=va,u=oa,R=F0*k0+j0*Z0,X=Z0*F0-k0*j0,W=f0);var sa=(4.7199672+(.2299715*V0-m0))%$,ba=(6.2565837+.017201977*V0)%$,wa=2*i0*y,R0=2*i0*y0,aa=2*Q*U,Oa=2*Q*(V-a0),Ta=-2*G*l,ja=-2*G*(d-t0),Fa=-2*G*(-21-9*o)*P0,ea=2*s0*j,Da=2*s0*(A-l0),Aa=-18*s0*P0,ta=-2*Q*O0,za=-2*Q*(r0-T),la=2*v0*L,La=2*v0*Y,Ca=2*F*x0,d2=2*F*(z0-g0),n2=-2*q*Z,i2=-2*q*(J-_),h2=-2*q*(-21-9*o)*T0,m2=2*B*c0,s2=2*B*(h0-a),t2=-18*B*T0,l2=-2*F*D0,x2=-2*F*(A0-M0);return{snodm:Z0,cnodm:k0,sinim:E0,cosim:G0,sinomm:q0,cosomm:b0,day:V0,e3:La,ee2:la,em:K0,emsq:o,gam:m0,peo:S0,pgho:ia,pho:ha,pinco:k,plo:ra,rtemsq:B0,se2:wa,se3:R0,sgh2:ea,sgh3:Da,sgh4:Aa,sh2:ta,sh3:za,si2:aa,si3:Oa,sl2:Ta,sl3:ja,sl4:Fa,s1:v0,s2:F,s3:q,s4:B,s5:z,s6:L,s7:Y,ss1:i0,ss2:Q,ss3:G,ss4:s0,ss5:P,ss6:y,ss7:y0,sz1:t0,sz2:l,sz3:d,sz11:a0,sz12:U,sz13:V,sz21:T,sz22:O0,sz23:r0,sz31:l0,sz32:j,sz33:A,xgh2:m2,xgh3:s2,xgh4:t2,xh2:l2,xh3:x2,xi2:Ca,xi3:d2,xl2:n2,xl3:i2,xl4:h2,nm:U0,z1:_,z2:Z,z3:J,z11:g0,z12:x0,z13:z0,z21:M0,z22:D0,z23:A0,z31:a,z32:c0,z33:h0,zmol:sa,zmos:ba}}function Xa(r){var v=r.cosim,i=r.argpo,n=r.s1,m=r.s2,s=r.s3,f=r.s4,x=r.s5,h=r.sinim,b=r.ss1,t=r.ss2,g=r.ss3,N=r.ss4,w=r.ss5,e0=r.sz1,S=r.sz3,C=r.sz11,O=r.sz13,W=r.sz21,H=r.sz23,E=r.sz31,p=r.sz33,e=r.t,K=r.tc,c=r.gsto,D=r.mo,d0=r.mdot,I=r.no,M=r.nodeo,R=r.nodedot,X=r.xpidot,n0=r.z1,u=r.z3,i0=r.z11,Q=r.z13,G=r.z21,s0=r.z23,P=r.z31,y=r.z33,y0=r.ecco,t0=r.eccsq,l=r.emsq,d=r.em,a0=r.argpm,U=r.inclm,V=r.mm,T=r.nm,O0=r.nodem,r0=r.irez,l0=r.atime,j=r.d2201,A=r.d2211,v0=r.d3210,F=r.d3222,q=r.d4410,B=r.d4422,z=r.d5220,L=r.d5232,Y=r.d5421,_=r.d5433,Z=r.dedt,J=r.didt,g0=r.dmdt,x0=r.dnodt,z0=r.domdt,M0=r.del1,D0=r.del2,A0=r.del3,a=r.xfact,c0=r.xlamo,h0=r.xli,P0=r.xni,T0,o0,f0,H0,L0,p0,Q0,U0,K0,Z0,k0,q0,b0,E0,G0,o,I0,B0,S0,k,ra,ia,ha,V0,Y0,u0,N0,va,oa,j0,F0,m0,_0=17891679e-13,Ma=21460748e-13,ua=22123015e-14,ya=17891679e-13,qa=73636953e-16,ma=21765803e-16,sa=.0043752690880113,ba=37393792e-14,wa=11428639e-14,R0=.00015835218,aa=119459e-10;r0=0,T<.0052359877&&T>.0034906585&&(r0=1),T>=.00826&&T<=.00924&&d>=.5&&(r0=2);var Oa=b*aa*w,Ta=t*aa*(C+O),ja=-aa*g*(e0+S-14-6*l),Fa=N*aa*(E+p-6),ea=-aa*t*(W+H);(U<.052359877||U>w0-.052359877)&&(ea=0),h!==0&&(ea/=h);var Da=Fa-v*ea;Z=Oa+n*R0*x,J=Ta+m*R0*(i0+Q),g0=ja-R0*s*(n0+u-14-6*l);var Aa=f*R0*(P+y-6),ta=-R0*m*(G+s0);(U<.052359877||U>w0-.052359877)&&(ta=0),z0=Da+Aa,x0=ea,h!==0&&(z0-=v/h*ta,x0+=ta/h);var za=0,la=(c+K*sa)%$;if(d+=Z*e,U+=J*e,a0+=z0*e,O0+=x0*e,V+=g0*e,r0!==0){if(j0=Math.pow(T/J0,na),r0===2){F0=v*v;var La=d;d=y0;var Ca=l;l=t0,m0=d*l,E0=-.306-(d-.64)*.44,d<=.65?(G0=3.616-13.247*d+16.29*l,I0=-19.302+117.39*d-228.419*l+156.591*m0,B0=-18.9068+109.7927*d-214.6334*l+146.5816*m0,S0=-41.122+242.694*d-471.094*l+313.953*m0,k=-146.407+841.88*d-1629.014*l+1083.435*m0,ra=-532.114+3017.977*d-5740.032*l+3708.276*m0):(G0=-72.099+331.819*d-508.738*l+266.724*m0,I0=-346.844+1582.851*d-2415.925*l+1246.113*m0,B0=-342.585+1554.908*d-2366.899*l+1215.972*m0,S0=-1052.797+4758.686*d-7193.992*l+3651.957*m0,k=-3581.69+16178.11*d-24462.77*l+12422.52*m0,d>.715?ra=-5149.66+29936.92*d-54087.36*l+31324.56*m0:ra=1464.74-4664.75*d+3763.64*l),d<.7?(V0=-919.2277+4988.61*d-9064.77*l+5542.21*m0,ia=-822.71072+4568.6173*d-8491.4146*l+5337.524*m0,ha=-853.666+4690.25*d-8624.77*l+5341.4*m0):(V0=-37995.78+161616.52*d-229838.2*l+109377.94*m0,ia=-51752.104+218913.95*d-309468.16*l+146349.42*m0,ha=-40023.88+170470.89*d-242699.48*l+115605.82*m0),Y0=h*h,T0=.75*(1+2*v+F0),o0=1.5*Y0,H0=1.875*h*(1-2*v-3*F0),L0=-1.875*h*(1+2*v-3*F0),Q0=35*Y0*T0,U0=39.375*Y0*Y0,K0=9.84375*h*(Y0*(1-2*v-5*F0)+.33333333*(-2+4*v+6*F0)),Z0=h*(4.92187512*Y0*(-2-4*v+10*F0)+6.56250012*(1+2*v-3*F0)),k0=29.53125*h*(2-8*v+F0*(-12+8*v+10*F0)),q0=29.53125*h*(-2-8*v+F0*(12+8*v-10*F0)),va=T*T,oa=j0*j0,N0=3*va*oa,u0=N0*ya,j=u0*T0*E0,A=u0*o0*G0,N0*=j0,u0=N0*ba,v0=u0*H0*I0,F=u0*L0*B0,N0*=j0,u0=2*N0*qa,q=u0*Q0*S0,B=u0*U0*k,N0*=j0,u0=N0*wa,z=u0*K0*ra,L=u0*Z0*ha,u0=2*N0*ma,Y=u0*k0*ia,_=u0*q0*V0,c0=(D+M+M-(la+la))%$,a=d0+g0+2*(R+x0-sa)-I,d=La,l=Ca}r0===1&&(b0=1+l*(-2.5+.8125*l),I0=1+2*l,o=1+l*(-6+6.60937*l),T0=.75*(1+v)*(1+v),f0=.9375*h*h*(1+3*v)-.75*(1+v),p0=1+v,p0*=1.875*p0*p0,M0=3*T*T*j0*j0,D0=2*M0*T0*b0*_0,A0=3*M0*p0*o*ua*j0,M0=M0*f0*I0*Ma*j0,c0=(D+M+i-la)%$,a=d0+X+g0+z0+x0-(I+sa)),h0=c0,P0=I,l0=0,T=I+za}return{em:d,argpm:a0,inclm:U,mm:V,nm:T,nodem:O0,irez:r0,atime:l0,d2201:j,d2211:A,d3210:v0,d3222:F,d4410:q,d4422:B,d5220:z,d5232:L,d5421:Y,d5433:_,dedt:Z,didt:J,dmdt:g0,dndt:za,dnodt:x0,domdt:z0,del1:M0,del2:D0,del3:A0,xfact:a,xlamo:c0,xli:h0,xni:P0}}function Ba(r){var v=(r-2451545)/36525,i=-62e-7*v*v*v+.093104*v*v+(876600*3600+8640184812866e-6)*v+67310.54841;return i=i*da/240%$,i<0&&(i+=$),i}function Za(r,v,i,n,m,s,f){return r instanceof Date?Ba(pa(r)):Ba(r)}function $a(r){var v=r.ecco,i=r.epoch,n=r.inclo,m=r.opsmode,s=r.no,f=v*v,x=1-f,h=Math.sqrt(x),b=Math.cos(n),t=b*b,g=Math.pow(J0/s,na),N=.75*X0*(3*t-1)/(h*x),w=N/(g*g),e0=g*(1-w*w-w*(1/3+134*w*w/81));w=N/(e0*e0),s/=1+w;var S=Math.pow(J0/s,na),C=Math.sin(n),O=S*x,W=1-5*t,H=-W-t-t,E=1/S,p=O*O,e=S*(1-v),K="n",c;if(m==="a"){var D=i-7305,d0=Math.floor(D+1e-8),I=D-d0,M=.017202791694070362,R=1.7321343856509375,X=5075514194322695e-30,n0=M+$;c=(R+M*d0+n0*I+D*D*X)%$,c<0&&(c+=$)}else c=Za(i+24332815e-1);return{no:s,method:K,ainv:E,ao:S,con41:H,con42:W,cosio:b,cosio2:t,eccsq:f,omeosq:x,posq:p,rp:e,rteosq:h,sinio:C,gsto:c}}function Sa(r){var v=r.irez,i=r.d2201,n=r.d2211,m=r.d3210,s=r.d3222,f=r.d4410,x=r.d4422,h=r.d5220,b=r.d5232,t=r.d5421,g=r.d5433,N=r.dedt,w=r.del1,e0=r.del2,S=r.del3,C=r.didt,O=r.dmdt,W=r.dnodt,H=r.domdt,E=r.argpo,p=r.argpdot,e=r.t,K=r.tc,c=r.gsto,D=r.xfact,d0=r.xlamo,I=r.no,M=r.atime,R=r.em,X=r.argpm,n0=r.inclm,u=r.xli,i0=r.mm,Q=r.xni,G=r.nodem,s0=r.nm,P=.13130908,y=2.8843198,y0=.37448087,t0=5.7686396,l=.95240898,d=1.8014998,a0=1.050833,U=4.4108898,V=.0043752690880113,T=720,O0=-720,r0=259200,l0,j,A,v0,F,q,B,z,L=0,Y=0,_=(c+K*V)%$;if(R+=N*e,n0+=C*e,X+=H*e,G+=W*e,i0+=O*e,v!==0){(M===0||e*M<=0||Math.abs(e)<Math.abs(M))&&(M=0,Q=I,u=d0),e>0?l0=T:l0=O0;for(var Z=381;Z===381;)v!==2?(B=w*Math.sin(u-P)+e0*Math.sin(2*(u-y))+S*Math.sin(3*(u-y0)),F=Q+D,q=w*Math.cos(u-P)+2*e0*Math.cos(2*(u-y))+3*S*Math.cos(3*(u-y0)),q*=F):(z=E+p*M,A=z+z,j=u+u,B=i*Math.sin(A+u-t0)+n*Math.sin(u-t0)+m*Math.sin(z+u-l)+s*Math.sin(-z+u-l)+f*Math.sin(A+j-d)+x*Math.sin(j-d)+h*Math.sin(z+u-a0)+b*Math.sin(-z+u-a0)+t*Math.sin(z+j-U)+g*Math.sin(-z+j-U),F=Q+D,q=i*Math.cos(A+u-t0)+n*Math.cos(u-t0)+m*Math.cos(z+u-l)+s*Math.cos(-z+u-l)+h*Math.cos(z+u-a0)+b*Math.cos(-z+u-a0)+2*(f*Math.cos(A+j-d)+x*Math.cos(j-d)+t*Math.cos(z+j-U)+g*Math.cos(-z+j-U)),q*=F),Math.abs(e-M)>=T?Z=381:(Y=e-M,Z=0),Z===381&&(u+=F*l0+B*r0,Q+=B*l0+q*r0,M+=l0);s0=Q+B*Y+q*Y*Y*.5,v0=u+F*Y+B*Y*Y*.5,v!==1?(i0=v0-2*G+2*_,L=s0-I):(i0=v0-G-X+_,L=s0-I),s0=I+L}return{atime:M,em:R,argpm:X,inclm:n0,xli:u,mm:i0,xni:Q,nodem:G,dndt:L,nm:s0}}var W0;(function(r){r[r.None=0]="None",r[r.MeanEccentricityOutOfRange=1]="MeanEccentricityOutOfRange",r[r.MeanMotionBelowZero=2]="MeanMotionBelowZero",r[r.PerturbedEccentricityOutOfRange=3]="PerturbedEccentricityOutOfRange",r[r.SemiLatusRectumBelowZero=4]="SemiLatusRectumBelowZero",r[r.Decayed=6]="Decayed"})(W0||(W0={}));function ka(r,v){var i,n,m,s,f,x,h,b,t,g,N,w,e0,S,C,O,W,H,E,p,e,K,c,D,d0,I,M,R=15e-13;r.t=v,r.error=W0.None;var X=r.mo+r.mdot*r.t,n0=r.argpo+r.argpdot*r.t,u=r.nodeo+r.nodedot*r.t;t=n0,e=X;var i0=r.t*r.t;if(c=u+r.nodecf*i0,W=1-r.cc1*r.t,H=r.bstar*r.cc4*r.t,E=r.t2cof*i0,r.isimp!==1){h=r.omgcof*r.t;var Q=1+r.eta*Math.cos(X);x=r.xmcof*(Q*Q*Q-r.delmo),O=h+x,e=X+O,t=n0-O,w=i0*r.t,e0=w*r.t,W=W-r.d2*i0-r.d3*w-r.d4*e0,H+=r.bstar*r.cc5*(Math.sin(e)-r.sinmao),E=E+r.t3cof*w+e0*(r.t4cof+r.t*r.t5cof)}K=r.no;var G=r.ecco;if(p=r.inclo,r.method==="d"){S=r.t;var s0={irez:r.irez,d2201:r.d2201,d2211:r.d2211,d3210:r.d3210,d3222:r.d3222,d4410:r.d4410,d4422:r.d4422,d5220:r.d5220,d5232:r.d5232,d5421:r.d5421,d5433:r.d5433,dedt:r.dedt,del1:r.del1,del2:r.del2,del3:r.del3,didt:r.didt,dmdt:r.dmdt,dnodt:r.dnodt,domdt:r.domdt,argpo:r.argpo,argpdot:r.argpdot,t:r.t,tc:S,gsto:r.gsto,xfact:r.xfact,xlamo:r.xlamo,no:r.no,atime:r.atime,em:G,argpm:t,inclm:p,xli:r.xli,mm:e,xni:r.xni,nodem:c,nm:K},P=Sa(s0);G=P.em,t=P.argpm,p=P.inclm,e=P.mm,c=P.nodem,K=P.nm}if(K<=0)return r.error=W0.MeanMotionBelowZero,null;var y=Math.pow(J0/K,na)*W*W;if(K=J0/Math.pow(y,1.5),G-=H,G>=1||G<-.001)return r.error=W0.MeanEccentricityOutOfRange,null;G<1e-6&&(G=1e-6),e+=r.no*E,d0=e+t+c,c%=$,t%=$,d0%=$,e=(d0-t-c)%$;var y0={am:y,em:G,im:p,Om:c,om:t,mm:e,nm:K},t0=Math.sin(p),l=Math.cos(p),d=G;if(D=p,g=t,M=c,I=e,s=t0,m=l,r.method==="d"){var a0={inclo:r.inclo,init:"n",ep:d,inclp:D,nodep:M,argpp:g,mp:I,opsmode:r.operationmode},U=Ua(r,a0);if(d=U.ep,M=U.nodep,g=U.argpp,I=U.mp,D=U.inclp,D<0&&(D=-D,M+=w0,g-=w0),d<0||d>1)return r.error=W0.PerturbedEccentricityOutOfRange,null}r.method==="d"&&(s=Math.sin(D),m=Math.cos(D),r.aycof=-.5*$0*s,Math.abs(m+1)>15e-13?r.xlcof=-.25*$0*s*(3+5*m)/(1+m):r.xlcof=-.25*$0*s*(3+5*m)/R);var V=d*Math.cos(g);O=1/(y*(1-d*d));var T=d*Math.sin(g)+O*r.aycof,O0=I+g+M+O*r.xlcof*V,r0=(O0-M)%$;b=r0,C=9999.9;for(var l0=1;Math.abs(C)>=1e-12&&l0<=10;)n=Math.sin(b),i=Math.cos(b),C=1-i*V-n*T,C=(r0-T*i+V*n-b)/C,Math.abs(C)>=.95&&(C>0?C=.95:C=-.95),b+=C,l0+=1;var j=V*i+T*n,A=V*n-T*i,v0=V*V+T*T,F=y*(1-v0);if(F<0)return r.error=W0.SemiLatusRectumBelowZero,null;var q=y*(1-j),B=Math.sqrt(y)*A/q,z=Math.sqrt(F)/q,L=Math.sqrt(1-v0);O=A/(1+L);var Y=y/q*(n-T-V*O),_=y/q*(i-V+T*O);N=Math.atan2(Y,_);var Z=(_+_)*Y,J=1-2*Y*Y;O=1/F;var g0=.5*X0*O,x0=g0*O;r.method==="d"&&(f=m*m,r.con41=3*f-1,r.x1mth2=1-f,r.x7thm1=7*f-1);var z0=q*(1-1.5*x0*L*r.con41)+.5*g0*r.x1mth2*J;if(z0<1)return r.error=W0.Decayed,null;N-=.25*x0*r.x7thm1*Z;var M0=M+1.5*x0*m*Z,D0=D+1.5*x0*m*s*J,A0=B-K*g0*r.x1mth2*Z/J0,a=z+K*g0*(r.x1mth2*J+1.5*r.con41)/J0,c0=Math.sin(N),h0=Math.cos(N),P0=Math.sin(M0),T0=Math.cos(M0),o0=Math.sin(D0),f0=Math.cos(D0),H0=-P0*f0,L0=T0*f0,p0=H0*c0+T0*h0,Q0=L0*c0+P0*h0,U0=o0*c0,K0=H0*h0-T0*c0,Z0=L0*h0-P0*c0,k0=o0*h0,q0={x:z0*p0*C0,y:z0*Q0*C0,z:z0*U0*C0},b0={x:(A0*p0+a*K0)*fa,y:(A0*Q0+a*Z0)*fa,z:(A0*U0+a*k0)*fa};return{position:q0,velocity:b0,meanElements:y0}}function _a(r,v){var i=v.opsmode,n=v.epoch,m=v.xbstar,s=v.xecco,f=v.xargpo,x=v.xinclo,h=v.xmo,b=v.xno,t=v.xnodeo,g,N,w,e0,S,C,O,W,H,E,p,e,K,c,D,d0,I,M,R,X,n0,u,i0,Q,G,s0,P,y,y0,t0,l,d,a0,U,V,T,O0,r0,l0,j,A,v0,F,q,B,z,L,Y,_,Z,J,g0,x0,z0,M0,D0,A0=15e-13,a=r;a.isimp=0,a.method="n",a.aycof=0,a.con41=0,a.cc1=0,a.cc4=0,a.cc5=0,a.d2=0,a.d3=0,a.d4=0,a.delmo=0,a.eta=0,a.argpdot=0,a.omgcof=0,a.sinmao=0,a.t=0,a.t2cof=0,a.t3cof=0,a.t4cof=0,a.t5cof=0,a.x1mth2=0,a.x7thm1=0,a.mdot=0,a.nodedot=0,a.xlcof=0,a.xmcof=0,a.nodecf=0,a.irez=0,a.d2201=0,a.d2211=0,a.d3210=0,a.d3222=0,a.d4410=0,a.d4422=0,a.d5220=0,a.d5232=0,a.d5421=0,a.d5433=0,a.dedt=0,a.del1=0,a.del2=0,a.del3=0,a.didt=0,a.dmdt=0,a.dnodt=0,a.domdt=0,a.e3=0,a.ee2=0,a.peo=0,a.pgho=0,a.pho=0,a.pinco=0,a.plo=0,a.se2=0,a.se3=0,a.sgh2=0,a.sgh3=0,a.sgh4=0,a.sh2=0,a.sh3=0,a.si2=0,a.si3=0,a.sl2=0,a.sl3=0,a.sl4=0,a.gsto=0,a.xfact=0,a.xgh2=0,a.xgh3=0,a.xgh4=0,a.xh2=0,a.xh3=0,a.xi2=0,a.xi3=0,a.xl2=0,a.xl3=0,a.xl4=0,a.xlamo=0,a.zmol=0,a.zmos=0,a.atime=0,a.xli=0,a.xni=0,a.bstar=m,a.ecco=s,a.argpo=f,a.inclo=x,a.mo=h,a.no=b,a.nodeo=t,a.operationmode=i;var c0=78/C0+1,h0=42/C0,P0=h0*h0*h0*h0;a.init="y",a.t=0;var T0={ecco:a.ecco,epoch:n,inclo:a.inclo,no:a.no,method:a.method,opsmode:a.operationmode},o0=$a(T0),f0=o0.ao,H0=o0.con42,L0=o0.cosio,p0=o0.cosio2,Q0=o0.eccsq,U0=o0.omeosq,K0=o0.posq,Z0=o0.rp,k0=o0.rteosq,q0=o0.sinio;if(a.no=o0.no,a.con41=o0.con41,a.gsto=o0.gsto,a.a=Math.pow(a.no*Ga,-2/3),a.alta=a.a*(1+a.ecco)-1,a.altp=a.a*(1-a.ecco)-1,a.error=0,U0>=0||a.no>=0){if(a.isimp=0,Z0<220/C0+1&&(a.isimp=1),P=c0,n0=P0,M=(Z0-1)*C0,M<156){P=M-78,M<98&&(P=20);var b0=(120-P)/C0;n0=b0*b0*b0*b0,P=P/C0+1}R=1/K0,z=1/(f0-P),a.eta=f0*a.ecco*z,e=a.eta*a.eta,p=a.ecco*a.eta,X=Math.abs(1-e),C=n0*Math.pow(z,4),O=C/Math.pow(X,3.5),e0=O*a.no*(f0*(1+1.5*e+p*(4+e))+.375*X0*z/X*a.con41*(8+3*e*(8+e))),a.cc1=a.bstar*e0,S=0,a.ecco>1e-4&&(S=-2*C*z*$0*a.no*q0/a.ecco),a.x1mth2=1-p0,a.cc4=2*a.no*O*f0*U0*(a.eta*(2+.5*e)+a.ecco*(.5+2*e)-X0*z/(f0*X)*(-3*a.con41*(1-2*p+e*(1.5-.5*p))+.75*a.x1mth2*(2*e-p*(1+e))*Math.cos(2*a.argpo))),a.cc5=2*O*f0*U0*(1+2.75*(e+p)+p*e),W=p0*p0,F=1.5*X0*R*a.no,q=.5*F*X0*R,B=-.46875*Ja*R*R*a.no,a.mdot=a.no+.5*F*k0*a.con41+.0625*q*k0*(13-78*p0+137*W),a.argpdot=-.5*F*H0+.0625*q*(7-114*p0+395*W)+B*(3-36*p0+49*W),Y=-F*L0,a.nodedot=Y+(.5*q*(4-19*p0)+2*B*(3-7*p0))*L0,L=a.argpdot+a.nodedot,a.omgcof=a.bstar*S*Math.cos(a.argpo),a.xmcof=0,a.ecco>1e-4&&(a.xmcof=-na*C*a.bstar/p),a.nodecf=3.5*U0*Y*a.cc1,a.t2cof=1.5*a.cc1,Math.abs(L0+1)>15e-13?a.xlcof=-.25*$0*q0*(3+5*L0)/(1+L0):a.xlcof=-.25*$0*q0*(3+5*L0)/A0,a.aycof=-.5*$0*q0;var E0=1+a.eta*Math.cos(a.mo);if(a.delmo=E0*E0*E0,a.sinmao=Math.sin(a.mo),a.x7thm1=7*p0-1,2*w0/a.no>=225){a.method="d",a.isimp=1,A=0,D=a.inclo;var G0={epoch:n,ep:a.ecco,argpp:a.argpo,tc:A,inclp:a.inclo,nodep:a.nodeo,np:a.no,e3:a.e3,ee2:a.ee2,peo:a.peo,pgho:a.pgho,pho:a.pho,pinco:a.pinco,plo:a.plo,se2:a.se2,se3:a.se3,sgh2:a.sgh2,sgh3:a.sgh3,sgh4:a.sgh4,sh2:a.sh2,sh3:a.sh3,si2:a.si2,si3:a.si3,sl2:a.sl2,sl3:a.sl3,sl4:a.sl4,xgh2:a.xgh2,xgh3:a.xgh3,xgh4:a.xgh4,xh2:a.xh2,xh3:a.xh3,xi2:a.xi2,xi3:a.xi3,xl2:a.xl2,xl3:a.xl3,xl4:a.xl4,zmol:a.zmol,zmos:a.zmos},o=Wa(G0);a.e3=o.e3,a.ee2=o.ee2,a.peo=o.peo,a.pgho=o.pgho,a.pho=o.pho,a.pinco=o.pinco,a.plo=o.plo,a.se2=o.se2,a.se3=o.se3,a.sgh2=o.sgh2,a.sgh3=o.sgh3,a.sgh4=o.sgh4,a.sh2=o.sh2,a.sh3=o.sh3,a.si2=o.si2,a.si3=o.si3,a.sl2=o.sl2,a.sl3=o.sl3,a.sl4=o.sl4,N=o.sinim,g=o.cosim,H=o.em,E=o.emsq,u=o.s1,i0=o.s2,Q=o.s3,G=o.s4,s0=o.s5,y=o.ss1,y0=o.ss2,t0=o.ss3,l=o.ss4,d=o.ss5,a0=o.sz1,U=o.sz3,V=o.sz11,T=o.sz13,O0=o.sz21,r0=o.sz23,l0=o.sz31,j=o.sz33,a.xgh2=o.xgh2,a.xgh3=o.xgh3,a.xgh4=o.xgh4,a.xh2=o.xh2,a.xh3=o.xh3,a.xi2=o.xi2,a.xi3=o.xi3,a.xl2=o.xl2,a.xl3=o.xl3,a.xl4=o.xl4,a.zmol=o.zmol,a.zmos=o.zmos,I=o.nm,_=o.z1,Z=o.z3,J=o.z11,g0=o.z13,x0=o.z21,z0=o.z23,M0=o.z31,D0=o.z33;var I0={inclo:D,init:a.init,ep:a.ecco,inclp:a.inclo,nodep:a.nodeo,argpp:a.argpo,mp:a.mo,opsmode:a.operationmode},B0=Ua(a,I0);a.ecco=B0.ep,a.inclo=B0.inclp,a.nodeo=B0.nodep,a.argpo=B0.argpp,a.mo=B0.mp,K=0,c=0,d0=0;var S0={cosim:g,emsq:E,argpo:a.argpo,s1:u,s2:i0,s3:Q,s4:G,s5:s0,sinim:N,ss1:y,ss2:y0,ss3:t0,ss4:l,ss5:d,sz1:a0,sz3:U,sz11:V,sz13:T,sz21:O0,sz23:r0,sz31:l0,sz33:j,t:a.t,tc:A,gsto:a.gsto,mo:a.mo,mdot:a.mdot,no:a.no,nodeo:a.nodeo,nodedot:a.nodedot,xpidot:L,z1:_,z3:Z,z11:J,z13:g0,z21:x0,z23:z0,z31:M0,z33:D0,ecco:a.ecco,eccsq:Q0,em:H,argpm:K,inclm:D,mm:d0,nm:I,nodem:c,irez:a.irez,atime:a.atime,d2201:a.d2201,d2211:a.d2211,d3210:a.d3210,d3222:a.d3222,d4410:a.d4410,d4422:a.d4422,d5220:a.d5220,d5232:a.d5232,d5421:a.d5421,d5433:a.d5433,dedt:a.dedt,didt:a.didt,dmdt:a.dmdt,dnodt:a.dnodt,domdt:a.domdt,del1:a.del1,del2:a.del2,del3:a.del3,xfact:a.xfact,xlamo:a.xlamo,xli:a.xli,xni:a.xni},k=Xa(S0);a.irez=k.irez,a.atime=k.atime,a.d2201=k.d2201,a.d2211=k.d2211,a.d3210=k.d3210,a.d3222=k.d3222,a.d4410=k.d4410,a.d4422=k.d4422,a.d5220=k.d5220,a.d5232=k.d5232,a.d5421=k.d5421,a.d5433=k.d5433,a.dedt=k.dedt,a.didt=k.didt,a.dmdt=k.dmdt,a.dnodt=k.dnodt,a.domdt=k.domdt,a.del1=k.del1,a.del2=k.del2,a.del3=k.del3,a.xfact=k.xfact,a.xlamo=k.xlamo,a.xli=k.xli,a.xni=k.xni}a.isimp!==1&&(w=a.cc1*a.cc1,a.d2=4*f0*z*w,v0=a.d2*z*a.cc1/3,a.d3=(17*f0+P)*v0,a.d4=.5*v0*f0*z*(221*f0+31*P)*a.cc1,a.t3cof=a.d2+2*w,a.t4cof=.25*(3*a.d3+a.cc1*(12*a.d2+10*w)),a.t5cof=.2*(3*a.d4+12*a.cc1*a.d3+6*a.d2*a.d2+15*w*(2*a.d2+w)))}ka(a,0),a.init="n"}function Ra(r,v){var i="i",n=0,m=r.substring(2,7),s=parseInt(r.substring(18,20),10),f=parseFloat(r.substring(20,32)),x=parseFloat(r.substring(33,43)),h=parseFloat("".concat(r.substring(44,45),".").concat(r.substring(45,50),"E").concat(r.substring(50,52))),b=parseFloat("".concat(r.substring(53,54),".").concat(r.substring(54,59),"E").concat(r.substring(59,61))),t=parseFloat(v.substring(8,16))*da,g=parseFloat(v.substring(17,25))*da,N=parseFloat(".".concat(v.substring(26,33).replace(/\s/g,"0"))),w=parseFloat(v.substring(34,42))*da,e0=parseFloat(v.substring(43,51))*da,S=parseFloat(v.substring(52,63))/Qa,C=s<57?s+2e3:s+1900,O=Va(C,f),W=O.mon,H=O.day,E=O.hr,p=O.minute,e=O.sec,K=pa(C,W,H,E,p,e),c={error:n,satnum:m,epochyr:s,epochdays:f,ndot:x,nddot:h,bstar:b,inclo:t,nodeo:g,ecco:N,argpo:w,mo:e0,no:S,jdsatepoch:K};return _a(c,{opsmode:i,satn:c.satnum,epoch:c.jdsatepoch-24332815e-1,xbstar:c.bstar,xecco:c.ecco,xargpo:c.argpo,xinclo:c.inclo,xmo:c.mo,xno:c.no,xnodeo:c.nodeo}),c}function a2(r){for(var v=arguments.length,i=new Array(v>1?v-1:0),n=1;n<v;n++)i[n-1]=arguments[n];var m=pa.apply(void 0,i),s=(m-r.jdsatepoch)*Ha;return ka(r,s)}function Ea(r){return r*Na}function r2(r){if(r<-w0/2||r>w0/2)throw new RangeError("Latitude radians must be in range [-pi/2; pi/2].");return Ea(r)}function v2(r){if(r<-w0||r>w0)throw new RangeError("Longitude radians must be in range [-pi; pi].");return Ea(r)}function o2(r,v){for(var i=6378.137,n=6356.7523142,m=Math.sqrt(r.x*r.x+r.y*r.y),s=(i-n)/i,f=2*s-s*s,x=Math.atan2(r.y,r.x)-v;x<-w0;)x+=$;for(;x>w0;)x-=$;for(var h=20,b=0,t=Math.atan2(r.z,Math.sqrt(r.x*r.x+r.y*r.y)),g;b++<h;)g=1/Math.sqrt(1-f*(Math.sin(t)*Math.sin(t))),t=Math.atan2(r.z+i*g*f*Math.sin(t),m);var N=m/Math.cos(t)-i*g;return{longitude:x,latitude:t,height:N}}let xa=[],ca=!1,ga=null;function e2(){const r=new Date,v=Za(r),i=[];for(const n of xa)try{const m=a2(n.satrec,r);if(!m)continue;const s=m.position,f=m.velocity;if(typeof s!="object"||s===null||Array.isArray(s)||typeof f!="object"||f===null||Array.isArray(f))continue;const x=o2(s,v),h=r2(x.latitude),b=v2(x.longitude),t=x.height/6371,g=Math.sqrt(f.x**2+f.y**2+f.z**2);i.push({id:n.id,name:n.name,group:n.group,lat:h,lng:b,alt:t,heightKm:x.height,velocity:g})}catch{}return i}function Ia(){if(!ca)return;const r=e2();self.postMessage({type:"FRAME",positions:r}),ga=setTimeout(Ia,100)}self.onmessage=r=>{const{type:v}=r.data;if(v==="LOAD"){const i=r.data.tles;xa=[];for(const n of i)try{const m=Ra(n.tle1,n.tle2);xa.push({id:n.id,name:n.name,group:n.group,satrec:m})}catch{}self.postMessage({type:"LOADED",count:xa.length})}else v==="START"?ca||(ca=!0,Ia()):v==="STOP"&&(ca=!1,ga!==null&&(clearTimeout(ga),ga=null))}})();
