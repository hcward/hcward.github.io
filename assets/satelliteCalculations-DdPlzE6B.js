(function(){"use strict";var J0=Math.PI,s0=J0*2,ea=J0/180,Pa=1440,La=398600.8,w0=6378.135,X0=60/Math.sqrt(w0*w0*w0/La),xa=w0*X0/60,Da=1/X0,K0=.001082616,ja=-253881e-11,Ba=-165597e-11,Q0=ja/K0,da=2/3,Sa=1440/(2*J0);function Ua(r,v){for(var i=[31,r%4===0?29:28,31,30,31,30,31,31,30,31,30,31],x=Math.floor(v),h=1,s=0;x>s+i[h-1]&&h<12;)s+=i[h-1],h+=1;var y=h,t=x-s,e=(v-x)*24,g=Math.floor(e);e=(e-g)*60;var c=Math.floor(e),q=(e-c)*60;return{mon:y,day:t,hr:g,minute:c,sec:q}}function Na(r,v,i,x,h,s){var y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;return 367*r-Math.floor(7*(r+Math.floor((v+9)/12))*.25)+Math.floor(275*v/9)+i+17210135e-1+((y/6e4+s/60+h)/60+x)/24}function ga(r,v,i,x,h,s){var y=arguments.length>6&&arguments[6]!==void 0?arguments[6]:0;if(r instanceof Date){var t=r;return Na(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}return Na(r,v,i,x,h,s,y)}function wa(r,v){var i=r.e3,x=r.ee2,h=r.peo,s=r.pgho,y=r.pho,t=r.pinco,e=r.plo,g=r.se2,c=r.se3,q=r.sgh2,D=r.sgh3,u=r.sgh4,$=r.sh2,k=r.sh3,N=r.si2,A=r.si3,J=r.sl2,w=r.sl3,F=r.sl4,z=r.t,n=r.xgh2,j=r.xgh3,l=r.xgh4,E=r.xh2,R=r.xh3,_=r.xi2,f=r.xi3,Q=r.xl2,V=r.xl3,a0=r.xl4,M=r.zmol,r0=r.zmos,X=v.init,S=v.opsmode,o0=v.ep,P=v.inclp,p=v.nodep,t0=v.argpp,c0=v.mp,m,d,n0,U,W,O,A0,e0,l0,T,L,d0,C,I,Z,b,B,G,v0,H,K,z0=119459e-10,x0=.01675,f0=.00015835218,y0=.0549;K=r0+z0*z,X==="y"&&(K=r0),H=K+2*x0*Math.sin(K),B=Math.sin(H),T=.5*B*B-.25,L=-.5*B*Math.cos(H);var T0=g*T+c*L,C0=N*T+A*L,a=J*T+w*L+F*B,g0=q*T+D*L+u*B,m0=$*T+k*L;K=M+f0*z,X==="y"&&(K=M),H=K+2*y0*Math.sin(K),B=Math.sin(H),T=.5*B*B-.25,L=-.5*B*Math.cos(H);var F0=x*T+i*L,I0=_*T+f*L,i0=Q*T+V*L+a0*B,M0=n*T+j*L+l*B,U0=E*T+R*L;return d0=T0+F0,Z=C0+I0,b=a+i0,C=g0+M0,I=m0+U0,X==="n"&&(d0-=h,Z-=t,b-=e,C-=s,I-=y,P+=Z,o0+=d0,U=Math.sin(P),n0=Math.cos(P),P>=.2?(I/=U,C-=n0*I,t0+=C,p+=I,c0+=b):(O=Math.sin(p),W=Math.cos(p),m=U*O,d=U*W,A0=I*W+Z*n0*O,e0=-I*O+Z*n0*W,m+=A0,d+=e0,p%=s0,p<0&&S==="a"&&(p+=s0),G=c0+t0+n0*p,l0=b+C-Z*p*U,G+=l0,v0=p,p=Math.atan2(m,d),p<0&&S==="a"&&(p+=s0),Math.abs(v0-p)>J0&&(p<v0?p+=s0:p-=s0),c0+=b,t0=G-c0-n0*p)),{ep:o0,inclp:P,nodep:p,argpp:t0,mp:c0}}function Za(r){var v=r.epoch,i=r.ep,x=r.argpp,h=r.tc,s=r.inclp,y=r.nodep,t=r.np,e,g,c,q,D,u,$,k,N,A,J,w,F,z,n,j,l,E,R,_,f,Q,V,a0,M,r0,X,S,o0,P,p,t0,c0,m,d,n0,U,W,O,A0,e0,l0,T,L,d0,C,I,Z,b,B,G,v0,H,K,z0,x0,f0,y0,T0,C0,a,g0,m0,F0=.01675,I0=.0549,i0=29864797e-13,M0=47968065e-14,U0=.39785416,N0=.91744867,p0=.1945905,G0=-.98088458,_0=t,Z0=i,L0=Math.sin(y),D0=Math.cos(y),q0=Math.sin(x),u0=Math.cos(x),j0=Math.sin(s),H0=Math.cos(s),o=Z0*Z0,B0=1-o,P0=Math.sqrt(B0),W0=0,Y=0,ra=0,ia=0,sa=0,k0=v+18261.5+h/1440,Y0=(4.523602-.00092422029*k0)%s0,b0=Math.sin(Y0),S0=Math.cos(Y0),va=.91375164-.03568096*S0,oa=Math.sqrt(1-va*va),E0=.089683511*b0/oa,O0=Math.sqrt(1-E0*E0),h0=5.8351514+.001944368*k0,$0=.39785416*b0/oa,za=O0*S0+.91744867*E0*b0;$0=Math.atan2($0,za),$0+=h0-Y0;var fa=Math.cos($0),Ma=Math.sin($0);_=p0,f=G0,a0=N0,M=U0,Q=D0,V=L0,J=i0;for(var pa=1/_0,ma=0;ma<2;)ma+=1,e=_*Q+f*a0*V,c=-f*Q+_*a0*V,$=-_*V+f*a0*Q,k=f*M,N=f*V+_*a0*Q,A=_*M,g=H0*$+j0*k,q=H0*N+j0*A,D=-j0*$+H0*k,u=-j0*N+H0*A,w=e*u0+g*q0,F=c*u0+q*q0,z=-e*q0+g*u0,n=-c*q0+q*u0,j=D*q0,l=u*q0,E=D*u0,R=u*u0,a=12*w*w-3*z*z,g0=24*w*F-6*z*n,m0=12*F*F-3*n*n,v0=3*(e*e+g*g)+a*o,H=6*(e*c+g*q)+g0*o,K=3*(c*c+q*q)+m0*o,z0=-6*e*D+o*(-24*w*E-6*z*j),x0=-6*(e*u+c*D)+o*(-24*(F*E+w*R)+-6*(z*l+n*j)),f0=-6*c*u+o*(-24*F*R-6*n*l),y0=6*g*D+o*(24*w*j-6*z*E),T0=6*(q*D+g*u)+o*(24*(F*j+w*l)-6*(n*E+z*R)),C0=6*q*u+o*(24*F*l-6*n*R),v0=v0+v0+B0*a,H=H+H+B0*g0,K=K+K+B0*m0,I=J*pa,C=-.5*I/P0,Z=I*P0,d0=-15*Z0*Z,b=w*z+F*n,B=F*z+w*n,G=F*n-w*z,ma===1&&(r0=d0,X=C,S=I,o0=Z,P=b,p=B,t0=G,c0=v0,m=H,d=K,n0=z0,U=x0,W=f0,O=y0,A0=T0,e0=C0,l0=a,T=g0,L=m0,_=fa,f=Ma,a0=va,M=oa,Q=O0*D0+E0*L0,V=L0*O0-D0*E0,J=M0);var ha=(4.7199672+(.2299715*k0-h0))%s0,ya=(6.2565837+.017201977*k0)%s0,ba=2*r0*p,R0=2*r0*t0,aa=2*X*U,qa=2*X*(W-n0),ua=-2*S*m,Aa=-2*S*(d-c0),Ia=-2*S*(-21-9*o)*F0,na=2*o0*T,Ea=2*o0*(L-l0),Oa=-18*o0*F0,ta=-2*X*A0,la=-2*X*(e0-O),ca=2*d0*B,Ta=2*d0*G,Ca=2*C*x0,Wa=2*C*(f0-z0),$a=-2*I*H,Ra=-2*I*(K-v0),a2=-2*I*(-21-9*o)*I0,r2=2*Z*g0,v2=2*Z*(m0-a),o2=-18*Z*I0,n2=-2*C*T0,e2=-2*C*(C0-y0);return{snodm:L0,cnodm:D0,sinim:j0,cosim:H0,sinomm:q0,cosomm:u0,day:k0,e3:Ta,ee2:ca,em:Z0,emsq:o,gam:h0,peo:W0,pgho:ia,pho:sa,pinco:Y,plo:ra,rtemsq:P0,se2:ba,se3:R0,sgh2:na,sgh3:Ea,sgh4:Oa,sh2:ta,sh3:la,si2:aa,si3:qa,sl2:ua,sl3:Aa,sl4:Ia,s1:d0,s2:C,s3:I,s4:Z,s5:b,s6:B,s7:G,ss1:r0,ss2:X,ss3:S,ss4:o0,ss5:P,ss6:p,ss7:t0,sz1:c0,sz2:m,sz3:d,sz11:n0,sz12:U,sz13:W,sz21:O,sz22:A0,sz23:e0,sz31:l0,sz32:T,sz33:L,xgh2:r2,xgh3:v2,xgh4:o2,xh2:n2,xh3:e2,xi2:Ca,xi3:Wa,xl2:$a,xl3:Ra,xl4:a2,nm:_0,z1:v0,z2:H,z3:K,z11:z0,z12:x0,z13:f0,z21:y0,z22:T0,z23:C0,z31:a,z32:g0,z33:m0,zmol:ha,zmos:ya}}function Ha(r){var v=r.cosim,i=r.argpo,x=r.s1,h=r.s2,s=r.s3,y=r.s4,t=r.s5,e=r.sinim,g=r.ss1,c=r.ss2,q=r.ss3,D=r.ss4,u=r.ss5,$=r.sz1,k=r.sz3,N=r.sz11,A=r.sz13,J=r.sz21,w=r.sz23,F=r.sz31,z=r.sz33,n=r.t,j=r.tc,l=r.gsto,E=r.mo,R=r.mdot,_=r.no,f=r.nodeo,Q=r.nodedot,V=r.xpidot,a0=r.z1,M=r.z3,r0=r.z11,X=r.z13,S=r.z21,o0=r.z23,P=r.z31,p=r.z33,t0=r.ecco,c0=r.eccsq,m=r.emsq,d=r.em,n0=r.argpm,U=r.inclm,W=r.mm,O=r.nm,A0=r.nodem,e0=r.irez,l0=r.atime,T=r.d2201,L=r.d2211,d0=r.d3210,C=r.d3222,I=r.d4410,Z=r.d4422,b=r.d5220,B=r.d5232,G=r.d5421,v0=r.d5433,H=r.dedt,K=r.didt,z0=r.dmdt,x0=r.dnodt,f0=r.domdt,y0=r.del1,T0=r.del2,C0=r.del3,a=r.xfact,g0=r.xlamo,m0=r.xli,F0=r.xni,I0,i0,M0,U0,N0,p0,G0,_0,Z0,L0,D0,q0,u0,j0,H0,o,B0,P0,W0,Y,ra,ia,sa,k0,Y0,b0,S0,va,oa,E0,O0,h0,$0=17891679e-13,za=21460748e-13,fa=22123015e-14,Ma=17891679e-13,pa=73636953e-16,ma=21765803e-16,ha=.0043752690880113,ya=37393792e-14,ba=11428639e-14,R0=.00015835218,aa=119459e-10;e0=0,O<.0052359877&&O>.0034906585&&(e0=1),O>=.00826&&O<=.00924&&d>=.5&&(e0=2);var qa=g*aa*u,ua=c*aa*(N+A),Aa=-aa*q*($+k-14-6*m),Ia=D*aa*(F+z-6),na=-aa*c*(J+w);(U<.052359877||U>J0-.052359877)&&(na=0),e!==0&&(na/=e);var Ea=Ia-v*na;H=qa+x*R0*t,K=ua+h*R0*(r0+X),z0=Aa-R0*s*(a0+M-14-6*m);var Oa=y*R0*(P+p-6),ta=-R0*h*(S+o0);(U<.052359877||U>J0-.052359877)&&(ta=0),f0=Ea+Oa,x0=na,e!==0&&(f0-=v/e*ta,x0+=ta/e);var la=0,ca=(l+j*ha)%s0;if(d+=H*n,U+=K*n,n0+=f0*n,A0+=x0*n,W+=z0*n,e0!==0){if(E0=Math.pow(O/X0,da),e0===2){O0=v*v;var Ta=d;d=t0;var Ca=m;m=c0,h0=d*m,j0=-.306-(d-.64)*.44,d<=.65?(H0=3.616-13.247*d+16.29*m,B0=-19.302+117.39*d-228.419*m+156.591*h0,P0=-18.9068+109.7927*d-214.6334*m+146.5816*h0,W0=-41.122+242.694*d-471.094*m+313.953*h0,Y=-146.407+841.88*d-1629.014*m+1083.435*h0,ra=-532.114+3017.977*d-5740.032*m+3708.276*h0):(H0=-72.099+331.819*d-508.738*m+266.724*h0,B0=-346.844+1582.851*d-2415.925*m+1246.113*h0,P0=-342.585+1554.908*d-2366.899*m+1215.972*h0,W0=-1052.797+4758.686*d-7193.992*m+3651.957*h0,Y=-3581.69+16178.11*d-24462.77*m+12422.52*h0,d>.715?ra=-5149.66+29936.92*d-54087.36*m+31324.56*h0:ra=1464.74-4664.75*d+3763.64*m),d<.7?(k0=-919.2277+4988.61*d-9064.77*m+5542.21*h0,ia=-822.71072+4568.6173*d-8491.4146*m+5337.524*h0,sa=-853.666+4690.25*d-8624.77*m+5341.4*h0):(k0=-37995.78+161616.52*d-229838.2*m+109377.94*h0,ia=-51752.104+218913.95*d-309468.16*m+146349.42*h0,sa=-40023.88+170470.89*d-242699.48*m+115605.82*h0),Y0=e*e,I0=.75*(1+2*v+O0),i0=1.5*Y0,U0=1.875*e*(1-2*v-3*O0),N0=-1.875*e*(1+2*v-3*O0),G0=35*Y0*I0,_0=39.375*Y0*Y0,Z0=9.84375*e*(Y0*(1-2*v-5*O0)+.33333333*(-2+4*v+6*O0)),L0=e*(4.92187512*Y0*(-2-4*v+10*O0)+6.56250012*(1+2*v-3*O0)),D0=29.53125*e*(2-8*v+O0*(-12+8*v+10*O0)),q0=29.53125*e*(-2-8*v+O0*(12+8*v-10*O0)),va=O*O,oa=E0*E0,S0=3*va*oa,b0=S0*Ma,T=b0*I0*j0,L=b0*i0*H0,S0*=E0,b0=S0*ya,d0=b0*U0*B0,C=b0*N0*P0,S0*=E0,b0=2*S0*pa,I=b0*G0*W0,Z=b0*_0*Y,S0*=E0,b0=S0*ba,b=b0*Z0*ra,B=b0*L0*sa,b0=2*S0*ma,G=b0*D0*ia,v0=b0*q0*k0,g0=(E+f+f-(ca+ca))%s0,a=R+z0+2*(Q+x0-ha)-_,d=Ta,m=Ca}e0===1&&(u0=1+m*(-2.5+.8125*m),B0=1+2*m,o=1+m*(-6+6.60937*m),I0=.75*(1+v)*(1+v),M0=.9375*e*e*(1+3*v)-.75*(1+v),p0=1+v,p0*=1.875*p0*p0,y0=3*O*O*E0*E0,T0=2*y0*I0*u0*$0,C0=3*y0*p0*o*fa*E0,y0=y0*M0*B0*za*E0,g0=(E+f+i-ca)%s0,a=R+V+z0+f0+x0-(_+ha)),m0=g0,F0=_,l0=0,O=_+la}return{em:d,argpm:n0,inclm:U,mm:W,nm:O,nodem:A0,irez:e0,atime:l0,d2201:T,d2211:L,d3210:d0,d3222:C,d4410:I,d4422:Z,d5220:b,d5232:B,d5421:G,d5433:v0,dedt:H,didt:K,dmdt:z0,dndt:la,dnodt:x0,domdt:f0,del1:y0,del2:T0,del3:C0,xfact:a,xlamo:g0,xli:m0,xni:F0}}function Fa(r){var v=(r-2451545)/36525,i=-62e-7*v*v*v+.093104*v*v+(876600*3600+8640184812866e-6)*v+67310.54841;return i=i*ea/240%s0,i<0&&(i+=s0),i}function Ya(r,v,i,x,h,s,y){return r instanceof Date?Fa(ga(r)):Fa(r)}function Ja(r){var v=r.ecco,i=r.epoch,x=r.inclo,h=r.opsmode,s=r.no,y=v*v,t=1-y,e=Math.sqrt(t),g=Math.cos(x),c=g*g,q=Math.pow(X0/s,da),D=.75*K0*(3*c-1)/(e*t),u=D/(q*q),$=q*(1-u*u-u*(1/3+134*u*u/81));u=D/($*$),s/=1+u;var k=Math.pow(X0/s,da),N=Math.sin(x),A=k*t,J=1-5*c,w=-J-c-c,F=1/k,z=A*A,n=k*(1-v),j="n",l;if(h==="a"){var E=i-7305,R=Math.floor(E+1e-8),_=E-R,f=.017202791694070362,Q=1.7321343856509375,V=5075514194322695e-30,a0=f+s0;l=(Q+f*R+a0*_+E*E*V)%s0,l<0&&(l+=s0)}else l=Ya(i+24332815e-1);return{no:s,method:j,ainv:F,ao:k,con41:w,con42:J,cosio:g,cosio2:c,eccsq:y,omeosq:t,posq:z,rp:n,rteosq:e,sinio:N,gsto:l}}function Xa(r){var v=r.irez,i=r.d2201,x=r.d2211,h=r.d3210,s=r.d3222,y=r.d4410,t=r.d4422,e=r.d5220,g=r.d5232,c=r.d5421,q=r.d5433,D=r.dedt,u=r.del1,$=r.del2,k=r.del3,N=r.didt,A=r.dmdt,J=r.dnodt,w=r.domdt,F=r.argpo,z=r.argpdot,n=r.t,j=r.tc,l=r.gsto,E=r.xfact,R=r.xlamo,_=r.no,f=r.atime,Q=r.em,V=r.argpm,a0=r.inclm,M=r.xli,r0=r.mm,X=r.xni,S=r.nodem,o0=r.nm,P=.13130908,p=2.8843198,t0=.37448087,c0=5.7686396,m=.95240898,d=1.8014998,n0=1.050833,U=4.4108898,W=.0043752690880113,O=720,A0=-720,e0=259200,l0,T,L,d0,C,I,Z,b,B=0,G=0,v0=(l+j*W)%s0;if(Q+=D*n,a0+=N*n,V+=w*n,S+=J*n,r0+=A*n,v!==0){(f===0||n*f<=0||Math.abs(n)<Math.abs(f))&&(f=0,X=_,M=R),n>0?l0=O:l0=A0;for(var H=381;H===381;)v!==2?(Z=u*Math.sin(M-P)+$*Math.sin(2*(M-p))+k*Math.sin(3*(M-t0)),C=X+E,I=u*Math.cos(M-P)+2*$*Math.cos(2*(M-p))+3*k*Math.cos(3*(M-t0)),I*=C):(b=F+z*f,L=b+b,T=M+M,Z=i*Math.sin(L+M-c0)+x*Math.sin(M-c0)+h*Math.sin(b+M-m)+s*Math.sin(-b+M-m)+y*Math.sin(L+T-d)+t*Math.sin(T-d)+e*Math.sin(b+M-n0)+g*Math.sin(-b+M-n0)+c*Math.sin(b+T-U)+q*Math.sin(-b+T-U),C=X+E,I=i*Math.cos(L+M-c0)+x*Math.cos(M-c0)+h*Math.cos(b+M-m)+s*Math.cos(-b+M-m)+e*Math.cos(b+M-n0)+g*Math.cos(-b+M-n0)+2*(y*Math.cos(L+T-d)+t*Math.cos(T-d)+c*Math.cos(b+T-U)+q*Math.cos(-b+T-U)),I*=C),Math.abs(n-f)>=O?H=381:(G=n-f,H=0),H===381&&(M+=C*l0+Z*e0,X+=Z*l0+I*e0,f+=l0);o0=X+Z*G+I*G*G*.5,d0=M+C*G+Z*G*G*.5,v!==1?(r0=d0-2*S+2*v0,B=o0-_):(r0=d0-S-V+v0,B=o0-_),o0=_+B}return{atime:f,em:Q,argpm:V,inclm:a0,xli:M,mm:r0,xni:X,nodem:S,dndt:B,nm:o0}}var V0;(function(r){r[r.None=0]="None",r[r.MeanEccentricityOutOfRange=1]="MeanEccentricityOutOfRange",r[r.MeanMotionBelowZero=2]="MeanMotionBelowZero",r[r.PerturbedEccentricityOutOfRange=3]="PerturbedEccentricityOutOfRange",r[r.SemiLatusRectumBelowZero=4]="SemiLatusRectumBelowZero",r[r.Decayed=6]="Decayed"})(V0||(V0={}));function _a(r,v){var i,x,h,s,y,t,e,g,c,q,D,u,$,k,N,A,J,w,F,z,n,j,l,E,R,_,f,Q=15e-13;r.t=v,r.error=V0.None;var V=r.mo+r.mdot*r.t,a0=r.argpo+r.argpdot*r.t,M=r.nodeo+r.nodedot*r.t;c=a0,n=V;var r0=r.t*r.t;if(l=M+r.nodecf*r0,J=1-r.cc1*r.t,w=r.bstar*r.cc4*r.t,F=r.t2cof*r0,r.isimp!==1){e=r.omgcof*r.t;var X=1+r.eta*Math.cos(V);t=r.xmcof*(X*X*X-r.delmo),A=e+t,n=V+A,c=a0-A,u=r0*r.t,$=u*r.t,J=J-r.d2*r0-r.d3*u-r.d4*$,w+=r.bstar*r.cc5*(Math.sin(n)-r.sinmao),F=F+r.t3cof*u+$*(r.t4cof+r.t*r.t5cof)}j=r.no;var S=r.ecco;if(z=r.inclo,r.method==="d"){k=r.t;var o0={irez:r.irez,d2201:r.d2201,d2211:r.d2211,d3210:r.d3210,d3222:r.d3222,d4410:r.d4410,d4422:r.d4422,d5220:r.d5220,d5232:r.d5232,d5421:r.d5421,d5433:r.d5433,dedt:r.dedt,del1:r.del1,del2:r.del2,del3:r.del3,didt:r.didt,dmdt:r.dmdt,dnodt:r.dnodt,domdt:r.domdt,argpo:r.argpo,argpdot:r.argpdot,t:r.t,tc:k,gsto:r.gsto,xfact:r.xfact,xlamo:r.xlamo,no:r.no,atime:r.atime,em:S,argpm:c,inclm:z,xli:r.xli,mm:n,xni:r.xni,nodem:l,nm:j},P=Xa(o0);S=P.em,c=P.argpm,z=P.inclm,n=P.mm,l=P.nodem,j=P.nm}if(j<=0)return r.error=V0.MeanMotionBelowZero,null;var p=Math.pow(X0/j,da)*J*J;if(j=X0/Math.pow(p,1.5),S-=w,S>=1||S<-.001)return r.error=V0.MeanEccentricityOutOfRange,null;S<1e-6&&(S=1e-6),n+=r.no*F,R=n+c+l,l%=s0,c%=s0,R%=s0,n=(R-c-l)%s0;var t0={am:p,em:S,im:z,Om:l,om:c,mm:n,nm:j},c0=Math.sin(z),m=Math.cos(z),d=S;if(E=z,q=c,f=l,_=n,s=c0,h=m,r.method==="d"){var n0={inclo:r.inclo,init:"n",ep:d,inclp:E,nodep:f,argpp:q,mp:_,opsmode:r.operationmode},U=wa(r,n0);if(d=U.ep,f=U.nodep,q=U.argpp,_=U.mp,E=U.inclp,E<0&&(E=-E,f+=J0,q-=J0),d<0||d>1)return r.error=V0.PerturbedEccentricityOutOfRange,null}r.method==="d"&&(s=Math.sin(E),h=Math.cos(E),r.aycof=-.5*Q0*s,Math.abs(h+1)>15e-13?r.xlcof=-.25*Q0*s*(3+5*h)/(1+h):r.xlcof=-.25*Q0*s*(3+5*h)/Q);var W=d*Math.cos(q);A=1/(p*(1-d*d));var O=d*Math.sin(q)+A*r.aycof,A0=_+q+f+A*r.xlcof*W,e0=(A0-f)%s0;g=e0,N=9999.9;for(var l0=1;Math.abs(N)>=1e-12&&l0<=10;)x=Math.sin(g),i=Math.cos(g),N=1-i*W-x*O,N=(e0-O*i+W*x-g)/N,Math.abs(N)>=.95&&(N>0?N=.95:N=-.95),g+=N,l0+=1;var T=W*i+O*x,L=W*x-O*i,d0=W*W+O*O,C=p*(1-d0);if(C<0)return r.error=V0.SemiLatusRectumBelowZero,null;var I=p*(1-T),Z=Math.sqrt(p)*L/I,b=Math.sqrt(C)/I,B=Math.sqrt(1-d0);A=L/(1+B);var G=p/I*(x-O-W*A),v0=p/I*(i-W+O*A);D=Math.atan2(G,v0);var H=(v0+v0)*G,K=1-2*G*G;A=1/C;var z0=.5*K0*A,x0=z0*A;r.method==="d"&&(y=h*h,r.con41=3*y-1,r.x1mth2=1-y,r.x7thm1=7*y-1);var f0=I*(1-1.5*x0*B*r.con41)+.5*z0*r.x1mth2*K;if(f0<1)return r.error=V0.Decayed,null;D-=.25*x0*r.x7thm1*H;var y0=f+1.5*x0*h*H,T0=E+1.5*x0*h*s*K,C0=Z-j*z0*r.x1mth2*H/X0,a=b+j*z0*(r.x1mth2*K+1.5*r.con41)/X0,g0=Math.sin(D),m0=Math.cos(D),F0=Math.sin(y0),I0=Math.cos(y0),i0=Math.sin(T0),M0=Math.cos(T0),U0=-F0*M0,N0=I0*M0,p0=U0*g0+I0*m0,G0=N0*g0+F0*m0,_0=i0*g0,Z0=U0*m0-I0*g0,L0=N0*m0-F0*g0,D0=i0*m0,q0={x:f0*p0*w0,y:f0*G0*w0,z:f0*_0*w0},u0={x:(C0*p0+a*Z0)*xa,y:(C0*G0+a*L0)*xa,z:(C0*_0+a*D0)*xa};return{position:q0,velocity:u0,meanElements:t0}}function Ga(r,v){var i=v.opsmode,x=v.epoch,h=v.xbstar,s=v.xecco,y=v.xargpo,t=v.xinclo,e=v.xmo,g=v.xno,c=v.xnodeo,q,D,u,$,k,N,A,J,w,F,z,n,j,l,E,R,_,f,Q,V,a0,M,r0,X,S,o0,P,p,t0,c0,m,d,n0,U,W,O,A0,e0,l0,T,L,d0,C,I,Z,b,B,G,v0,H,K,z0,x0,f0,y0,T0,C0=15e-13,a=r;a.isimp=0,a.method="n",a.aycof=0,a.con41=0,a.cc1=0,a.cc4=0,a.cc5=0,a.d2=0,a.d3=0,a.d4=0,a.delmo=0,a.eta=0,a.argpdot=0,a.omgcof=0,a.sinmao=0,a.t=0,a.t2cof=0,a.t3cof=0,a.t4cof=0,a.t5cof=0,a.x1mth2=0,a.x7thm1=0,a.mdot=0,a.nodedot=0,a.xlcof=0,a.xmcof=0,a.nodecf=0,a.irez=0,a.d2201=0,a.d2211=0,a.d3210=0,a.d3222=0,a.d4410=0,a.d4422=0,a.d5220=0,a.d5232=0,a.d5421=0,a.d5433=0,a.dedt=0,a.del1=0,a.del2=0,a.del3=0,a.didt=0,a.dmdt=0,a.dnodt=0,a.domdt=0,a.e3=0,a.ee2=0,a.peo=0,a.pgho=0,a.pho=0,a.pinco=0,a.plo=0,a.se2=0,a.se3=0,a.sgh2=0,a.sgh3=0,a.sgh4=0,a.sh2=0,a.sh3=0,a.si2=0,a.si3=0,a.sl2=0,a.sl3=0,a.sl4=0,a.gsto=0,a.xfact=0,a.xgh2=0,a.xgh3=0,a.xgh4=0,a.xh2=0,a.xh3=0,a.xi2=0,a.xi3=0,a.xl2=0,a.xl3=0,a.xl4=0,a.xlamo=0,a.zmol=0,a.zmos=0,a.atime=0,a.xli=0,a.xni=0,a.bstar=h,a.ecco=s,a.argpo=y,a.inclo=t,a.mo=e,a.no=g,a.nodeo=c,a.operationmode=i;var g0=78/w0+1,m0=42/w0,F0=m0*m0*m0*m0;a.init="y",a.t=0;var I0={ecco:a.ecco,epoch:x,inclo:a.inclo,no:a.no,method:a.method,opsmode:a.operationmode},i0=Ja(I0),M0=i0.ao,U0=i0.con42,N0=i0.cosio,p0=i0.cosio2,G0=i0.eccsq,_0=i0.omeosq,Z0=i0.posq,L0=i0.rp,D0=i0.rteosq,q0=i0.sinio;if(a.no=i0.no,a.con41=i0.con41,a.gsto=i0.gsto,a.a=Math.pow(a.no*Da,-2/3),a.alta=a.a*(1+a.ecco)-1,a.altp=a.a*(1-a.ecco)-1,a.error=0,_0>=0||a.no>=0){if(a.isimp=0,L0<220/w0+1&&(a.isimp=1),P=g0,a0=F0,f=(L0-1)*w0,f<156){P=f-78,f<98&&(P=20);var u0=(120-P)/w0;a0=u0*u0*u0*u0,P=P/w0+1}Q=1/Z0,b=1/(M0-P),a.eta=M0*a.ecco*b,n=a.eta*a.eta,z=a.ecco*a.eta,V=Math.abs(1-n),N=a0*Math.pow(b,4),A=N/Math.pow(V,3.5),$=A*a.no*(M0*(1+1.5*n+z*(4+n))+.375*K0*b/V*a.con41*(8+3*n*(8+n))),a.cc1=a.bstar*$,k=0,a.ecco>1e-4&&(k=-2*N*b*Q0*a.no*q0/a.ecco),a.x1mth2=1-p0,a.cc4=2*a.no*A*M0*_0*(a.eta*(2+.5*n)+a.ecco*(.5+2*n)-K0*b/(M0*V)*(-3*a.con41*(1-2*z+n*(1.5-.5*z))+.75*a.x1mth2*(2*n-z*(1+n))*Math.cos(2*a.argpo))),a.cc5=2*A*M0*_0*(1+2.75*(n+z)+z*n),J=p0*p0,C=1.5*K0*Q*a.no,I=.5*C*K0*Q,Z=-.46875*Ba*Q*Q*a.no,a.mdot=a.no+.5*C*D0*a.con41+.0625*I*D0*(13-78*p0+137*J),a.argpdot=-.5*C*U0+.0625*I*(7-114*p0+395*J)+Z*(3-36*p0+49*J),G=-C*N0,a.nodedot=G+(.5*I*(4-19*p0)+2*Z*(3-7*p0))*N0,B=a.argpdot+a.nodedot,a.omgcof=a.bstar*k*Math.cos(a.argpo),a.xmcof=0,a.ecco>1e-4&&(a.xmcof=-da*N*a.bstar/z),a.nodecf=3.5*_0*G*a.cc1,a.t2cof=1.5*a.cc1,Math.abs(N0+1)>15e-13?a.xlcof=-.25*Q0*q0*(3+5*N0)/(1+N0):a.xlcof=-.25*Q0*q0*(3+5*N0)/C0,a.aycof=-.5*Q0*q0;var j0=1+a.eta*Math.cos(a.mo);if(a.delmo=j0*j0*j0,a.sinmao=Math.sin(a.mo),a.x7thm1=7*p0-1,2*J0/a.no>=225){a.method="d",a.isimp=1,L=0,E=a.inclo;var H0={epoch:x,ep:a.ecco,argpp:a.argpo,tc:L,inclp:a.inclo,nodep:a.nodeo,np:a.no,e3:a.e3,ee2:a.ee2,peo:a.peo,pgho:a.pgho,pho:a.pho,pinco:a.pinco,plo:a.plo,se2:a.se2,se3:a.se3,sgh2:a.sgh2,sgh3:a.sgh3,sgh4:a.sgh4,sh2:a.sh2,sh3:a.sh3,si2:a.si2,si3:a.si3,sl2:a.sl2,sl3:a.sl3,sl4:a.sl4,xgh2:a.xgh2,xgh3:a.xgh3,xgh4:a.xgh4,xh2:a.xh2,xh3:a.xh3,xi2:a.xi2,xi3:a.xi3,xl2:a.xl2,xl3:a.xl3,xl4:a.xl4,zmol:a.zmol,zmos:a.zmos},o=Za(H0);a.e3=o.e3,a.ee2=o.ee2,a.peo=o.peo,a.pgho=o.pgho,a.pho=o.pho,a.pinco=o.pinco,a.plo=o.plo,a.se2=o.se2,a.se3=o.se3,a.sgh2=o.sgh2,a.sgh3=o.sgh3,a.sgh4=o.sgh4,a.sh2=o.sh2,a.sh3=o.sh3,a.si2=o.si2,a.si3=o.si3,a.sl2=o.sl2,a.sl3=o.sl3,a.sl4=o.sl4,D=o.sinim,q=o.cosim,w=o.em,F=o.emsq,M=o.s1,r0=o.s2,X=o.s3,S=o.s4,o0=o.s5,p=o.ss1,t0=o.ss2,c0=o.ss3,m=o.ss4,d=o.ss5,n0=o.sz1,U=o.sz3,W=o.sz11,O=o.sz13,A0=o.sz21,e0=o.sz23,l0=o.sz31,T=o.sz33,a.xgh2=o.xgh2,a.xgh3=o.xgh3,a.xgh4=o.xgh4,a.xh2=o.xh2,a.xh3=o.xh3,a.xi2=o.xi2,a.xi3=o.xi3,a.xl2=o.xl2,a.xl3=o.xl3,a.xl4=o.xl4,a.zmol=o.zmol,a.zmos=o.zmos,_=o.nm,v0=o.z1,H=o.z3,K=o.z11,z0=o.z13,x0=o.z21,f0=o.z23,y0=o.z31,T0=o.z33;var B0={inclo:E,init:a.init,ep:a.ecco,inclp:a.inclo,nodep:a.nodeo,argpp:a.argpo,mp:a.mo,opsmode:a.operationmode},P0=wa(a,B0);a.ecco=P0.ep,a.inclo=P0.inclp,a.nodeo=P0.nodep,a.argpo=P0.argpp,a.mo=P0.mp,j=0,l=0,R=0;var W0={cosim:q,emsq:F,argpo:a.argpo,s1:M,s2:r0,s3:X,s4:S,s5:o0,sinim:D,ss1:p,ss2:t0,ss3:c0,ss4:m,ss5:d,sz1:n0,sz3:U,sz11:W,sz13:O,sz21:A0,sz23:e0,sz31:l0,sz33:T,t:a.t,tc:L,gsto:a.gsto,mo:a.mo,mdot:a.mdot,no:a.no,nodeo:a.nodeo,nodedot:a.nodedot,xpidot:B,z1:v0,z3:H,z11:K,z13:z0,z21:x0,z23:f0,z31:y0,z33:T0,ecco:a.ecco,eccsq:G0,em:w,argpm:j,inclm:E,mm:R,nm:_,nodem:l,irez:a.irez,atime:a.atime,d2201:a.d2201,d2211:a.d2211,d3210:a.d3210,d3222:a.d3222,d4410:a.d4410,d4422:a.d4422,d5220:a.d5220,d5232:a.d5232,d5421:a.d5421,d5433:a.d5433,dedt:a.dedt,didt:a.didt,dmdt:a.dmdt,dnodt:a.dnodt,domdt:a.domdt,del1:a.del1,del2:a.del2,del3:a.del3,xfact:a.xfact,xlamo:a.xlamo,xli:a.xli,xni:a.xni},Y=Ha(W0);a.irez=Y.irez,a.atime=Y.atime,a.d2201=Y.d2201,a.d2211=Y.d2211,a.d3210=Y.d3210,a.d3222=Y.d3222,a.d4410=Y.d4410,a.d4422=Y.d4422,a.d5220=Y.d5220,a.d5232=Y.d5232,a.d5421=Y.d5421,a.d5433=Y.d5433,a.dedt=Y.dedt,a.didt=Y.didt,a.dmdt=Y.dmdt,a.dnodt=Y.dnodt,a.domdt=Y.domdt,a.del1=Y.del1,a.del2=Y.del2,a.del3=Y.del3,a.xfact=Y.xfact,a.xlamo=Y.xlamo,a.xli=Y.xli,a.xni=Y.xni}a.isimp!==1&&(u=a.cc1*a.cc1,a.d2=4*M0*b*u,d0=a.d2*b*a.cc1/3,a.d3=(17*M0+P)*d0,a.d4=.5*d0*M0*b*(221*M0+31*P)*a.cc1,a.t3cof=a.d2+2*u,a.t4cof=.25*(3*a.d3+a.cc1*(12*a.d2+10*u)),a.t5cof=.2*(3*a.d4+12*a.cc1*a.d3+6*a.d2*a.d2+15*u*(2*a.d2+u)))}_a(a,0),a.init="n"}function ka(r,v){var i="i",x=0,h=r.substring(2,7),s=parseInt(r.substring(18,20),10),y=parseFloat(r.substring(20,32)),t=parseFloat(r.substring(33,43)),e=parseFloat("".concat(r.substring(44,45),".").concat(r.substring(45,50),"E").concat(r.substring(50,52))),g=parseFloat("".concat(r.substring(53,54),".").concat(r.substring(54,59),"E").concat(r.substring(59,61))),c=parseFloat(v.substring(8,16))*ea,q=parseFloat(v.substring(17,25))*ea,D=parseFloat(".".concat(v.substring(26,33))),u=parseFloat(v.substring(34,42))*ea,$=parseFloat(v.substring(43,51))*ea,k=parseFloat(v.substring(52,63))/Sa,N=s<57?s+2e3:s+1900,A=Ua(N,y),J=A.mon,w=A.day,F=A.hr,z=A.minute,n=A.sec,j=ga(N,J,w,F,z,n),l={error:x,satnum:h,epochyr:s,epochdays:y,ndot:t,nddot:e,bstar:g,inclo:c,nodeo:q,ecco:D,argpo:u,mo:$,no:k,jdsatepoch:j};return Ga(l,{opsmode:i,satn:l.satnum,epoch:l.jdsatepoch-24332815e-1,xbstar:l.bstar,xecco:l.ecco,xargpo:l.argpo,xinclo:l.inclo,xmo:l.mo,xno:l.no,xnodeo:l.nodeo}),l}function Va(r){for(var v=arguments.length,i=new Array(v>1?v-1:0),x=1;x<v;x++)i[x-1]=arguments[x];var h=ga.apply(void 0,i),s=(h-r.jdsatepoch)*Pa;return _a(r,s)}function Ka(r,v){try{if(!r.SEMIMAJOR_AXIS||!r.PERIOD||!r.EPOCH||!r.ECCENTRICITY||!r.INCLINATION||!r.RA_OF_ASC_NODE||!r.ARG_OF_PERICENTER||!r.MEAN_MOTION||!r.MEAN_ANOMALY)return null;const i=new Date(r.EPOCH),x=(v.getTime()-i.getTime())/(1e3*60),h=r.SEMIMAJOR_AXIS,s=parseFloat(r.ECCENTRICITY),y=parseFloat(r.INCLINATION)*Math.PI/180,t=parseFloat(r.RA_OF_ASC_NODE)*Math.PI/180,e=parseFloat(r.ARG_OF_PERICENTER)*Math.PI/180,g=parseFloat(r.MEAN_MOTION)*2*Math.PI/1440,q=parseFloat(r.MEAN_ANOMALY)*Math.PI/180+g*x;let D=q;for(let t0=0;t0<3;t0++)D=q+s*Math.sin(D);const u=Math.sqrt((1+s)/(1-s)),$=2*Math.atan(u*Math.tan(D/2)),k=h*(1-s*Math.cos(D)),N=Math.cos($),A=Math.sin($),J=k*N,w=k*A,F=Math.cos(t),z=Math.sin(t),n=Math.cos(y),j=Math.sin(y),l=Math.cos(e),E=Math.sin(e),R=F*l,_=F*E,f=z*l,Q=z*E,V=R-Q*n,a0=-_-f*n,M=f+_*n,r0=-Q+R*n,X=E*j,S=l*j,o0=V*J+a0*w,P=M*J+r0*w,p=X*J+S*w;return{x:o0,y:P,z:p}}catch(i){return console.warn("Error in simulateOrbitFromElements:",i),null}}function Qa(r,v,i,x){const h=[],s=Math.min(i+x,r.length);for(let y=i;y<s;y++){const t=r[y];let e=null;if(t.TLE_LINE1&&t.TLE_LINE2)try{const g=ka(t.TLE_LINE1,t.TLE_LINE2);if(g){const c=Va(g,v);c?.position&&typeof c.position=="object"&&(e=c.position)}}catch(g){console.warn("TLE propagation failed for satellite:",t.NORAD_CAT_ID,g),e=null}!e&&t.SEMIMAJOR_AXIS&&t.PERIOD&&t.EPOCH&&(e=Ka(t,v)),h.push({index:y,position:e,satellite:t})}return h}self.onmessage=function(r){const{type:v,satellites:i,currentTime:x}=r.data;if(v==="CALCULATE_POSITIONS"){let h=function(){const g=e*t;if(g>=i.length){const q={type:"POSITIONS_CALCULATED",results:y};self.postMessage(q);return}const c=Qa(i,s,g,t);y.push(...c),e++,setTimeout(h,0)};const s=new Date(x),y=[],t=500;let e=0;h()}}})();
